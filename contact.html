<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contact - Thonsee Health</title>
  <link rel="stylesheet" href="style.css" />
  <script defer src="compte.js"></script>
  <script defer src="panier.js"></script>
  <script defer src="auth.js"></script>
  <script defer src="utilisateur.js"></script>
  <script defer src="commandes.js"></script>
</head>

<style>

/* Titre principal */
.titre {
  text-align: center;
  font-size: 36px;
  color: #FFD700;
  margin-top: 60px;
}

/* Texte principal */
main.fade-in {
  text-align: center;
  padding: 20px;
}

/* Bouton d'action */
.cta {
  display: inline-block;
  background-color: #FFD700;
  color: #0D0D0D;
  padding: 12px 24px;
  margin-top: 20px;
  font-weight: bold;
  text-decoration: none;
  border-radius: 8px;
  transition: background-color 0.3s ease;
}

.cta:hover {
  background-color: #e6c200;
}

/* Section PayPal */
.paypal-section {
  text-align: center;
  margin: 60px 20px;
  border-top: 1px solid #FFD700;
  padding-top: 40px;
}

.paypal-section h2 {
  color: #FFD700;
  font-size: 24px;
  margin-bottom: 20px;
}

.paypal-qr {
  max-width: 220px;
  width: 90%;
  height: auto;
  max-height: 300px;
  margin: 20px 0;
  border: 3px solid #FFD700;
  border-radius: 10px;
}

/* Lien PayPal */
.paypal-section a {
  color: #FFD700;
  text-decoration: underline;
  font-weight: bold;
}

/* Pied de page */
footer {
  text-align: center;
  padding: 20px;
  background-color: #0D0D0D;
  border-top: 1px solid #FFD700;
  font-size: 14px;
  color: #ccc;
}

/* Responsive */
@media screen and (max-width: 768px) {
  header.tete {
    flex-direction: column;
    align-items: center;
    text-align: center;
  }

  .menu {
    flex-direction: column;
    gap: 10px;
    margin-top: 15px;
  }

  .titre {
    font-size: 28px;
  }

  .cta {
    font-size: 16px;
    padding: 10px 20px;
  }

  .paypal-section {
    margin: 40px 10px;
  }
}


</style>

<body>
<header class="tete">
       <!-- Ic√¥ne utilisateur -->
    <div class="user" onclick="toggleAccountsPopup()" style="cursor:pointer;">
  <a class="text-decoration" href="parametre.html"><div id="userIcon">üë§</div></a>
  
</div>
    <div class="logo">Thonsee <span>Health</span></div>
    <nav class="menu">
      <a href="index.html">Accueil</a>
      <a href="produits.html">Nos Produits</a>
      <a href="contact.html">Contact</a>
      <a href="panier.html">Panier <span id="cartCountNav" >0</span></a>
      <a href="#" onclick="toggleLoginPopup(); return false;">Se connecter</a>
      <a href="#" onclick="toggleRegisterPopup(); return false;">S'inscrire</a>
    </nav>
  </header>

  <section class="texte">
  <main class="fade-in">
    <h1 class="titre">Contactez-nous</h1>
    <p>Utilisez le formulaire ou nos coordonn√©es pour toute question.</p>
    <a href="https://www.godaddy.com/fr/domainsearch/find?domainToCheck=thonseehealth.com" class="cta">Acheter ce site</a>
  </main>

  <section class="paypal-section">
    <h2>Paiement s√©curis√© via PayPal</h2>
    <img src="paypal (1).png" alt="QR Code PayPal" class="paypal-qr">
    <p>
      Ou cliquez ici :
      <a href="https://www.paypal.me" target="_blank">payer via PayPal</a>
    </p>
  </section>
  </section>

  <footer>
    <p>&copy; 2025 Thonsee Health. Tous droits r√©serv√©s.</p>
  </footer>

  <!-- Popups inchang√©s -->
  <!-- ... tous les <div> et <script> de ton ancien code restent ici sans modification ... -->

  <div id="accountPopup" class="popup hidden">
    <div class="popup-content">
      <span class="close-btn" onclick="togglePopup()">&times;</span>
      <h2>Connexion / Inscription</h2>
      <form id="accountForm">
        <input type="text" id="popupUsername" placeholder="Nom d'utilisateur" required />
        <input type="password" id="popupPassword" placeholder="Mot de passe" required />
        <button type="submit">Se connecter / Cr√©er un compte</button>
      </form>
      <div id="popupMessage"></div>
    </div>
  </div>

 <!-- Popup d'√©dition (ADMIN) -->
  <div id="editPopup" class="popup hidden">
    <div class="popup-content">
      <h2>Modifier le contenu</h2>
      <textarea id="editTextarea" rows="6" style="width: 100%;"></textarea>
      <button onclick="saveEditedText()">Enregistrer</button>
      <button onclick="closeEditPopup()">Annuler</button>
    </div>
  </div>

  <!-- POPUP CONNEXION -->
  <div id="loginPopup" class="popup hidden">
    <form id="loginForm" class="popup-content">
      <h2>Connexion</h2>
      <input type="email" id="loginUsername" placeholder="Email" required />
      <input type="password" id="loginPassword" placeholder="Mot de passe" required />
      <p id="loginMessage" class="message"></p>
      <button type="submit">Se connecter</button>
      <button type="button" onclick="toggleLoginPopup()">Fermer</button>
    </form>
  </div>

  <!-- POPUP INSCRIPTION -->
  <div id="registerPopup" class="popup hidden">
    <form id="registerForm" class="popup-content">
      <h2>Inscription</h2>
      <input type="email" id="registerUsername" placeholder="Email" required />
      <input type="password" id="registerPassword" placeholder="Mot de passe" required />
      <p id="registerMessage" class="message"></p>
      <button type="submit">S‚Äôinscrire</button>
      <button type="button" onclick="toggleRegisterPopup()">Fermer</button>
    </form>
  </div>

  <script>
    function toggleLoginPopup() {
      const loginPopup = document.getElementById("loginPopup");
      loginPopup.classList.toggle("hidden");
    }
  </script>


  <script>

// Appel au chargement de la page
window.addEventListener('DOMContentLoaded', updateCartCount);

</script>

<!-- notif panier -->

<script>
async function majNotifCommandes() {
  const userName = localStorage.getItem("currentUser");
  const notifElem = document.getElementById("notifCommande");

  if (!userName || !notifElem) return;

  try {
    const res = await fetch("http://localhost:3000/api/commandes");
    if (!res.ok) throw new Error("Erreur API");

    const commandes = await res.json();
    const commandesUser = commandes.filter(cmd => cmd.utilisateur === userName);

    if (commandesUser.length > 0) {
      notifElem.textContent = commandesUser.length;
      notifElem.style.display = "inline-block";
    } else {
      notifElem.style.display = "none";
    }
  } catch (err) {
    console.error("Erreur chargement commandes :", err.message);
  }
}

window.addEventListener('DOMContentLoaded', majNotifCommandes);
</script>

  <script>
function ajouterAuPanier(button) {
  const produitDiv = button.closest('.produit');

  const nom = produitDiv.getAttribute('data-nom');
  const prix = parseFloat(produitDiv.getAttribute('data-prix'));
  const imgElem = produitDiv.querySelector('img');
  const imageUrl = imgElem ? imgElem.src : '';

  const currentUser = localStorage.getItem('currentUser');
  if (!currentUser) {
    alert("Vous devez √™tre connect√© pour ajouter au panier.");
    return;
  }

  // Panier sp√©cifique √† l'utilisateur
  let panier = JSON.parse(localStorage.getItem(`cart_${currentUser}`)) || [];

  const produitExistant = panier.find(item => item.nom === nom);

  if (produitExistant) {
    produitExistant.quantite++;
  } else {
    panier.push({ nom: nom, prix: prix, quantite: 1, imageUrl: imageUrl });
  }

  localStorage.setItem(`cart_${currentUser}`, JSON.stringify(panier));

  updateCartCount();
  alert(`${nom} a √©t√© ajout√© au panier !`);
}

function getCart() {
  const currentUser = localStorage.getItem('currentUser');
  if (!currentUser) return [];
  return JSON.parse(localStorage.getItem(`cart_${currentUser}`)) || [];
}

function updateCartCount() {
  const cart = getCart();
  const totalQuantity = cart.reduce((sum, item) => sum + (item.quantite || 0), 0);
  const countElem = document.getElementById('cartCountNav');
  if (!countElem) return;

  if (totalQuantity > 0) {
    countElem.style.display = 'inline';
    countElem.textContent = totalQuantity;
  } else {
    countElem.style.display = 'none';
  }
}

// Affiche le nom d'utilisateur ou "Non connect√©"
function afficherNomUtilisateur() {
  const currentUser = localStorage.getItem('currentUser');
  const userNameDiv = document.getElementById('userName');

  if (userNameDiv) {
    userNameDiv.textContent = currentUser ? currentUser : "Non connect√©";
  }
}

window.addEventListener('DOMContentLoaded', () => {
  updateCartCount();
  afficherNomUtilisateur();
});
</script>

<!-- fermerture de le pop up d'inscrition -->

<script>
  // Ferme la popup d'inscription apr√®s inscription r√©ussie
  const registerForm = document.getElementById('registerForm');
  const registerPopup = document.getElementById('registerPopup');
  const registerMessage = document.getElementById('registerMessage');

  if (registerForm) {
    registerForm.addEventListener('submit', function (e) {
      e.preventDefault();

      const username = document.getElementById('registerUsername').value.trim();
      const password = document.getElementById('registerPassword').value.trim();

      // V√©rifie que le formulaire est valide (ou ajoute tes conditions ici)
      if (username && password) {
        // Enregistre dans le localStorage
        let users = JSON.parse(localStorage.getItem('users')) || [];
        const userExists = users.some(user => user.username === username);

        if (userExists) {
          registerMessage.textContent = "Ce nom d'utilisateur existe d√©j√†.";
        } else {
          users.push({ username, password });
          localStorage.setItem('users', JSON.stringify(users));
          localStorage.setItem('currentUser', username);

          registerMessage.textContent = "Compte cr√©√© avec succ√®s !";

          // Ferme la popup apr√®s un court d√©lai (facultatif)
          setTimeout(() => {
            toggleRegisterPopup(); // Ferme la pop-up
            registerForm.reset();  // R√©initialise le formulaire
            registerMessage.textContent = ""; // Vide le message
          }, 1000);
        }
      }
    });
  }

  // Fonction pour ouvrir/fermer la popup
  function toggleRegisterPopup() {
    registerPopup.classList.toggle('hidden');
  }
</script>

<script>
  const loginForm = document.getElementById("loginForm");
  const loginMessage = document.getElementById("loginMessage");

  loginForm.addEventListener("submit", function (e) {
    e.preventDefault();

    const username = document.getElementById("loginUsername").value.trim();
    const password = document.getElementById("loginPassword").value.trim();
    const accounts = JSON.parse(localStorage.getItem("accounts")) || {};

    if (accounts[username] && accounts[username] === password) {
      localStorage.setItem("currentUser", username);
      loginMessage.textContent = "Connexion r√©ussie !";
      loginMessage.style.color = "lightgreen";

      // Ferme la popup apr√®s 500ms
      setTimeout(() => {
        document.getElementById("loginPopup").classList.add("hidden");
        loginMessage.textContent = "";
        loginForm.reset();
        location.reload(); // recharge la page ou redirige si tu veux
      }, 500);
    } else {
      loginMessage.textContent = "Nom d'utilisateur ou mot de passe incorrect.";
      loginMessage.style.color = "red";
    }
  });

  const loginPopup = document.getElementById("loginPopup");

  // Fermer la popup en cliquant √† l'ext√©rieur
  window.addEventListener("click", function (event) {
    if (event.target === loginPopup) {
      loginPopup.classList.add("hidden");
      document.getElementById("loginForm").reset();
      document.getElementById("loginMessage").textContent = "";
    }
  });


  // Fermer la popup d'inscription en cliquant √† l'ext√©rieur
  window.addEventListener("click", function (event) {
    if (event.target === registerPopup) {
      registerPopup.classList.add("hidden");
      document.getElementById("registerForm").reset();
      document.getElementById("registerMessage").textContent = "";
    }
  });
</script>



<script>
function enregistrerUtilisateur() {
  const email = document.getElementById("registerUsername").value.trim();
  const password = document.getElementById("registerPassword").value.trim();
  const messageElem = document.getElementById("registerMessage");

  if (!email || !password) {
    messageElem.textContent = "Veuillez remplir tous les champs.";
    messageElem.style.color = "red";
    return;
  }

  fetch("http://localhost:3000/api/users", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email, password })
  })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
        messageElem.textContent = "‚úÖ Compte cr√©√© avec succ√®s.";
        messageElem.style.color = "green";

        // Tu peux stocker le nom pour l‚Äôutiliser plus tard
        localStorage.setItem("userName", email);
      } else if (data.error) {
        messageElem.textContent = "‚ùå " + data.error;
        messageElem.style.color = "red";
      }
    })
    .catch(error => {
      console.error("Erreur serveur :", error);
      messageElem.textContent = "‚ùå Erreur de communication avec le serveur.";
      messageElem.style.color = "red";
    });
}

// Lier au formulaire d‚Äôinscription
document.getElementById("registerForm").addEventListener("submit", function (e) {
  e.preventDefault();
  enregistrerUtilisateur();
});

</script>


</body>
</html>
